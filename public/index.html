<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PanicSense - Disaster Intelligence Platform</title>
    <link rel="stylesheet" href="/styles.css">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta name="description" content="PanicSense provides advanced, AI-driven emergency insights and community safety coordination.">
</head>
<body>
    <header class="header">
        <div class="container">
            <h1>PanicSense</h1>
            <nav class="nav">
                <a href="/">Home</a>
                <a href="/disasters">Disasters</a>
                <a href="/api-docs">API</a>
                <a href="/about">About</a>
            </nav>
        </div>
    </header>

    <div class="container mt-20">
        <section class="card">
            <h2 class="card-title">Welcome to PanicSense</h2>
            <p>PanicSense is a disaster intelligence platform that provides advanced, AI-driven emergency insights and community safety coordination across multiple platforms.</p>
            <p>Our platform uses advanced machine learning algorithms to analyze social media, news sources, and community reports to provide real-time disaster intelligence.</p>
        </section>

        <h2 class="mt-20">Recent Disaster Events</h2>
        <div class="event-list" id="disaster-events">
            <!-- Disaster events will be loaded here via JavaScript -->
            <div class="event-card">
                <div class="severity severity-high">High Severity</div>
                <h3>Loading disaster events...</h3>
                <p>Please wait while we fetch the latest disaster information.</p>
            </div>
        </div>

        <section class="card mt-20">
            <h2 class="card-title">Community Sentiment</h2>
            <p>Recent sentiment analysis from community posts:</p>
            <div id="sentiment-posts">
                <!-- Sentiment posts will be loaded here via JavaScript -->
                <p>Loading sentiment data...</p>
            </div>
        </section>

        <section class="card mt-20">
            <h2 class="card-title">API Documentation</h2>
            <p>PanicSense offers a comprehensive API for developers to integrate disaster intelligence into their applications.</p>
            
            <div class="endpoint">
                <h3>GET /api/health</h3>
                <p>Check the health status of the PanicSense API.</p>
                <pre><code>curl -X GET http://localhost:5001/api/health</code></pre>
            </div>
            
            <div class="endpoint">
                <h3>GET /api/disaster-events</h3>
                <p>Get a list of recent disaster events.</p>
                <pre><code>curl -X GET http://localhost:5001/api/disaster-events</code></pre>
            </div>
            
            <div class="endpoint">
                <h3>GET /api/sentiment-posts</h3>
                <p>Get recent sentiment analysis from community posts.</p>
                <pre><code>curl -X GET http://localhost:5001/api/sentiment-posts</code></pre>
            </div>
            
            <div class="endpoint">
                <h3>GET /api/analyzed-files</h3>
                <p>Get a list of analyzed data files.</p>
                <pre><code>curl -X GET http://localhost:5001/api/analyzed-files</code></pre>
            </div>
        </section>
    </div>

    <footer class="footer">
        <div class="container">
            <div class="footer-col">
                <h3>PanicSense</h3>
                <p>Advanced Disaster Intelligence Platform</p>
            </div>
            <div class="footer-col">
                <h3>Resources</h3>
                <ul>
                    <li><a href="/api-docs">API Documentation</a></li>
                    <li><a href="/developers">Developers</a></li>
                    <li><a href="/tutorials">Tutorials</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h3>About</h3>
                <ul>
                    <li><a href="/about">About Us</a></li>
                    <li><a href="/contact">Contact</a></li>
                    <li><a href="/privacy">Privacy Policy</a></li>
                </ul>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 PanicSense. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        // Simple JavaScript to fetch and display data from our API
        document.addEventListener('DOMContentLoaded', function() {
            // Fetch disaster events
            fetch('/api/disaster-events')
                .then(response => response.json())
                .then(data => {
                    const eventsContainer = document.getElementById('disaster-events');
                    eventsContainer.innerHTML = '';
                    
                    if (data.length === 0) {
                        eventsContainer.innerHTML = '<p>No disaster events found.</p>';
                        return;
                    }
                    
                    data.forEach(event => {
                        const severityClass = event.severity === 'high' ? 'severity-high' : 
                                             event.severity === 'moderate' ? 'severity-moderate' : 
                                             'severity-low';
                        
                        const eventHtml = `
                            <div class="event-card">
                                <div class="severity ${severityClass}">${event.severity || 'Unknown'} Severity</div>
                                <h3>${event.title || event.name || 'Untitled Event'}</h3>
                                <p>${event.description || 'No description available.'}</p>
                                <p><strong>Location:</strong> ${event.location || 'Unknown'}</p>
                                <p><small>Date: ${new Date(event.created_at).toLocaleString()}</small></p>
                            </div>
                        `;
                        eventsContainer.innerHTML += eventHtml;
                    });
                })
                .catch(error => {
                    console.error('Error fetching disaster events:', error);
                    document.getElementById('disaster-events').innerHTML = '<p>Error loading disaster events. Please try again later.</p>';
                });
            
            // Fetch sentiment posts
            fetch('/api/sentiment-posts')
                .then(response => response.json())
                .then(data => {
                    const postsContainer = document.getElementById('sentiment-posts');
                    postsContainer.innerHTML = '';
                    
                    if (data.length === 0) {
                        postsContainer.innerHTML = '<p>No sentiment posts found.</p>';
                        return;
                    }
                    
                    // Create a table for sentiment posts
                    let tableHtml = `
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Text</th>
                                    <th>Sentiment</th>
                                    <th>Date</th>
                                </tr>
                            </thead>
                            <tbody>
                    `;
                    
                    data.slice(0, 5).forEach(post => {
                        tableHtml += `
                            <tr>
                                <td>${post.text}</td>
                                <td>${post.sentiment || 'Unknown'}</td>
                                <td>${new Date(post.created_at || post.timestamp).toLocaleString()}</td>
                            </tr>
                        `;
                    });
                    
                    tableHtml += `
                            </tbody>
                        </table>
                    `;
                    
                    postsContainer.innerHTML = tableHtml;
                })
                .catch(error => {
                    console.error('Error fetching sentiment posts:', error);
                    document.getElementById('sentiment-posts').innerHTML = '<p>Error loading sentiment data. Please try again later.</p>';
                });
        });
    </script>
</body>
</html>